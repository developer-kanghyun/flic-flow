import{d as m,r as s,e as k,f as N,h as R,i as _,k as L,l as E,m as q,n as T,j as e}from"./index-CfLsdFtj.js";import{f as z,d as O,e as V,g as B,h as H,M as W}from"./omdbApi-2yeBWvXP.js";import"./WatchListButton-ctmsFqyD.js";import"./styles-D_SSWYD2.js";const U=m.div.withConfig({displayName:"styles__StyledDetailPage",componentId:"sc-wj0kfq-0"})(["min-height:100vh;background-color:",";color:",";.loading,.error{display:flex;justify-content:center;align-items:center;height:50vh;font-size:1.2rem;text-align:center;}"],({theme:t})=>t.colors.background,({theme:t})=>t.colors.text),Y=m.div.withConfig({displayName:"styles__ContentContainer",componentId:"sc-wj0kfq-1"})(["max-width:1200px;margin:0 auto;padding:40px 20px;display:grid;grid-template-columns:2fr 1fr;gap:40px;align-items:start;@media (max-width:768px){grid-template-columns:1fr;gap:30px;padding:20px;}"]),A=m.main.withConfig({displayName:"styles__MainContent",componentId:"sc-wj0kfq-2"})(["h2{color:",";font-size:1.8rem;margin-bottom:20px;font-weight:600;}p{font-size:1.1rem;line-height:1.7;color:",";opacity:0.9;}"],({theme:t})=>t.colors.primary,({theme:t})=>t.colors.text),F=m.aside.withConfig({displayName:"styles__Sidebar",componentId:"sc-wj0kfq-3"})(["display:flex;flex-direction:column;gap:24px;"]),G=m.section.withConfig({displayName:"styles__RecommendationsSection",componentId:"sc-wj0kfq-4"})(["max-width:1200px;margin:0 auto;padding:0 20px 40px;"]),J=(t,a)=>{const[v,w]=s.useState(null),[u,o]=s.useState(null),[g,l]=s.useState([]),[C,h]=s.useState(!1),[j,c]=s.useState({imdbRating:null,rottenTomatoesRating:null}),[y,p]=s.useState(null),[b,d]=s.useState({isLoading:!0,error:null}),x=s.useCallback(async()=>{if(!t){d({isLoading:!1,error:"잘못된 영화 ID입니다."});return}const r=parseInt(t,10);if(isNaN(r)){d({isLoading:!1,error:"잘못된 영화 ID 형식입니다."});return}d({isLoading:!0,error:null});try{const[i,S,M,D,P]=await Promise.allSettled([k(r,a||void 0),N(r,a||void 0),R(r,a||void 0),_(r,a||void 0),L(r,a||void 0)]);if(i.status==="fulfilled")w(i.value);else throw new Error("영화 정보를 불러올 수 없습니다.");if(S.status==="fulfilled"?o(S.value):(console.warn("크레딧 정보를 불러오지 못했습니다:",S.reason),o(null)),M.status==="fulfilled"?l(M.value):(console.warn("추천 영화를 불러오지 못했습니다:",M.reason),l([])),D.status==="fulfilled"){const n=D.value.filter(f=>f.type==="Trailer"&&f.site==="YouTube");h(n.length>0)}else console.warn("비디오 정보를 불러오지 못했습니다:",D.reason),h(!1);if(P.status==="fulfilled"?p(P.value):(console.warn("시청 제공업체 정보를 불러오지 못했습니다:",P.reason),p(null)),i.status==="fulfilled")try{const n=await z(i.value.id);if(n){const f=await O(n);f&&c(f)}}catch(n){console.warn("외부 평점 정보를 불러오지 못했습니다:",n)}d({isLoading:!1,error:null})}catch(i){console.error("Error fetching movie details:",i),d({isLoading:!1,error:E(i)})}},[t,a]),I=s.useCallback(()=>{x()},[x]);return s.useEffect(()=>{x()},[x]),{movie:v,credits:u,recommendations:g,hasTrailer:C,ratings:j,watchProviders:y,loadingState:b,refetch:I}},$=()=>{const{id:t}=q(),[a]=T(),v=a.get("type"),[w,u]=s.useState(!1),{movie:o,credits:g,recommendations:l,hasTrailer:C,ratings:h,watchProviders:j,loadingState:c}=J(t,v),y=()=>{u(!0)},p=()=>{u(!1)};return c.isLoading?e.jsx("div",{className:"loading",children:"영화 상세 정보 로딩 중..."}):c.error?e.jsx("div",{className:"error",style:{color:"red"},children:c.error}):o?e.jsxs(U,{children:[e.jsx(V,{movie:o,hasTrailer:C,isVideoModalOpen:w,onPlayTrailer:y,onCloseModal:p}),e.jsxs(Y,{children:[e.jsxs(A,{children:[e.jsx("h2",{children:"줄거리"}),e.jsx("p",{children:o.overview||"줄거리 정보가 없습니다."})]}),e.jsxs(F,{children:[e.jsx(B,{movie:o,ratings:h,watchProviders:j}),g&&e.jsx(H,{credits:g})]})]}),l.length>0&&e.jsx(G,{children:e.jsx(W,{movies:l,title:"추천 영화"})})]}):e.jsx("div",{className:"error",children:"영화 정보를 찾을 수 없습니다."})};export{$ as default};
