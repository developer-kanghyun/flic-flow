import{j as e,S as R,A as $,F as W,u as S,a as V,b as G,r as n,c as F,g as q,d as z,e as H,f as J,h as K,L as P,i as Q,k as U,l as o}from"./index-dsj1h1mw.js";import{S as X,a as Y,b as Z,M as h}from"./styles-D1oTfKf6.js";import{W as A}from"./WatchListButton-DscP-xHz.js";const ee=()=>e.jsx(R,{children:e.jsx($,{title:"OTT 플랫폼",children:e.jsx(W,{})})}),se=[{key:"all",label:"전체"},{key:"new",label:"신작"},{key:"popular",label:"인기"},{key:"drama",label:"드라마"},{key:"animation",label:"애니메이션"},{key:"documentary",label:"다큐멘터리"},{key:"entertainment",label:"예능"},{key:"sports",label:"스포츠"}],te=()=>{const{activeTag:a,setActiveTag:r}=S();return e.jsx(V,{children:se.map(s=>e.jsx(G,{$active:a===s.key,onClick:()=>r(s.key),children:s.label},s.key))})},re=()=>{const{selectedOtts:a}=S(),[r,s]=n.useState([]),[c,t]=n.useState(!0),[l,x]=n.useState(null);if(n.useEffect(()=>{(async()=>{try{const d=await q();s(d||[])}catch(d){console.error("Error fetching all watch providers:",d),x("OTT 제공사 정보를 불러오는 데 실패했습니다.")}finally{t(!1)}})()},[]),c)return null;if(l)return e.jsx("p",{style:{color:"red"},children:l});const p=r.filter(i=>a.includes(i.provider_id));return p.length===0?e.jsxs(F,{children:[e.jsx("h3",{children:"이용 중인 서비스"}),e.jsx("p",{children:"선택된 OTT가 없습니다."})]}):e.jsxs(F,{children:[e.jsx("h3",{children:"이용 중인 서비스"}),e.jsx("div",{children:p.map(i=>e.jsx("img",{src:`https://image.tmdb.org/t/p/original${i.logo_path}`,alt:i.provider_name,title:i.provider_name},i.provider_id))})]})},ae=({movies:a,title:r})=>{if(a.length===0)return null;const s=a.slice(0,5),c=a.slice(5);return e.jsxs(z,{children:[r&&e.jsx("h2",{children:r}),e.jsx(H,{children:s.map((t,l)=>e.jsxs(J,{children:[e.jsx(K,{children:l+1}),e.jsx(P,{to:`/detail/${t.id}`,children:t.poster_path?e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster_path}`,alt:t.title}):e.jsx("div",{className:"no-image",children:"No Image"})}),e.jsxs(Q,{children:[e.jsx("h3",{children:t.title}),e.jsxs("p",{children:["⭐ ",t.vote_average.toFixed(1)]})]}),e.jsx(A,{movieId:t.id})]},t.id))}),c.length>0&&e.jsxs(U,{children:[e.jsx("h3",{children:"더 많은 콘텐츠"}),e.jsx("div",{className:"carousel-container",children:c.map(t=>e.jsxs("div",{className:"carousel-item",children:[e.jsx(P,{to:`/detail/${t.id}`,children:t.poster_path?e.jsx("img",{src:`https://image.tmdb.org/t/p/w500${t.poster_path}`,alt:t.title}):e.jsx("div",{className:"no-image",children:"No Image"})}),e.jsx(A,{movieId:t.id})]},t.id))})]})]})},ne=a=>{switch(a){case"new":return"신작";case"popular":return"인기";case"drama":return"드라마";case"animation":return"애니메이션";case"documentary":return"다큐멘터리";case"entertainment":return"예능";case"sports":return"스포츠";case"all":return"전체 콘텐츠";default:return"콘텐츠"}},ie=async(a,r)=>{const s={sortBy:"popular",count:30};switch(r){case"new":s.sortBy="primary_release_date.desc";break;case"popular":break;case"drama":s.genreIds=[18],s.mediaType="tv";break;case"animation":s.genreIds=[16];break;case"documentary":s.genreIds=[99],s.mediaType="tv";break;case"entertainment":s.genreIds=[10767],s.mediaType="tv";break;case"sports":s.genreIds=[10770],s.mediaType="movie";break}return o({...a,...s})},le=a=>{const r={...a,count:5},s={...r,sortBy:"popular"};return Promise.all([o({...r,sortBy:"primary_release_date.desc"}),o(s),o({...s,genreIds:[18],mediaType:"tv"}),o({...s,genreIds:[16]}),o({...s,genreIds:[99]}),o({...s,genreIds:[10767],mediaType:"tv"}),o({...s,genreIds:[10770],mediaType:"movie"})])},ue=()=>{const{selectedOtts:a,activeTag:r}=S(),[s,c]=n.useState([]),[t,l]=n.useState([]),[x,p]=n.useState([]),[i,d]=n.useState([]),[m,f]=n.useState([]),[v,k]=n.useState([]),[g,T]=n.useState([]),[y,b]=n.useState(!0),[j,I]=n.useState(null),w=()=>{c([]),l([]),d([]),f([]),k([]),p([]),T([])},_=n.useCallback(async()=>{b(!0),I(null);try{const u={ottIds:a};if(r&&r!=="all"){const M=await ie(u,r);w(),l(M)}else{const[M,B,E,N,O,C,D]=await le(u);c(M),l(B),d(E),f(N),k(O),p(C),T(D)}}catch(u){console.error("Error fetching movies:",u),I("영화를 불러오는 데 실패했습니다."),w()}finally{b(!1)}},[a,r]);n.useEffect(()=>{_()},[_]);const L=!y&&!j&&[s,t,i,m,v,x,g].every(u=>u.length===0);return e.jsx(e.Fragment,{children:e.jsxs(X,{children:[e.jsx(ee,{}),e.jsxs(Y,{children:[e.jsx(re,{}),e.jsx(te,{})]}),e.jsxs(Z,{children:[y&&e.jsx("p",{children:"영화 로딩 중..."}),j&&e.jsx("p",{style:{color:"red"},children:j}),!y&&!j&&e.jsxs(e.Fragment,{children:[r!=="all"?e.jsx(ae,{movies:t,title:ne(r||"all")}):e.jsxs(e.Fragment,{children:[s.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"신작"}),e.jsx(h,{movies:s})]}),t.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"인기"}),e.jsx(h,{movies:t})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"드라마"}),e.jsx(h,{movies:i})]}),m.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"애니메이션"}),e.jsx(h,{movies:m})]}),v.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"다큐멘터리"}),e.jsx(h,{movies:v})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"예능"}),e.jsx(h,{movies:x})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("h2",{children:"스포츠"}),e.jsx(h,{movies:g})]})]}),L&&e.jsx("p",{children:"표시할 영화가 없습니다. 필터를 조정해보세요."})]})]})]})})};export{ue as default};
