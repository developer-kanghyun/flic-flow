import{r as i,j as e,m as x,n as j,o as v,p as S,q as w,s as b,t as T,v as M,O as _,w as m,x as k,y as P,z as E,B}from"./index-dsj1h1mw.js";import{W as C}from"./WatchListButton-DscP-xHz.js";const I="/assets/triangleRight-Dx0SvmsB.png",L=({movieId:t,movie:s})=>{const[r,d]=i.useState(null),[c,o]=i.useState(!1),[h,n]=i.useState(!0),[p,a]=i.useState(null);i.useEffect(()=>{(async()=>{n(!0),a(null);try{const y=(await S(t)).find(g=>g.type==="Trailer"&&g.site==="YouTube");y?d(y.key):a("예고편을 찾을 수 없습니다.")}catch(f){console.error("Error fetching movie videos:",f),a("예고편을 불러오는 데 실패했습니다.")}finally{n(!1)}})()},[t]);const l=()=>{o(!0)};if(h)return e.jsx(x,{children:"예고편 로딩 중..."});if(p)return e.jsx(x,{style:{color:"red"},children:p});const u=s.backdrop_path?`https://image.tmdb.org/t/p/w1280${s.backdrop_path}`:s.poster_path?`https://image.tmdb.org/t/p/w500${s.poster_path}`:"";return e.jsx(x,{children:c?e.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${r}?autoplay=1`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"Movie Trailer"}):e.jsx(j,{src:u,children:r&&e.jsx(v,{onClick:l,children:e.jsx("img",{src:I,alt:"Play Trailer"})})})})},O=({movie:t})=>e.jsxs(w,{children:[e.jsx("h2",{children:t.title}),e.jsxs("p",{children:[e.jsx("strong",{children:"개봉일:"})," ",t.release_date]}),e.jsxs("p",{children:[e.jsx("strong",{children:"평점:"})," ",t.vote_average]}),e.jsxs("p",{children:[e.jsx("strong",{children:"줄거리:"})," ",t.overview]})]}),W=({movieId:t,movieTitle:s})=>{const[r,d]=i.useState(null),[c,o]=i.useState(!0),[h,n]=i.useState(null);if(i.useEffect(()=>{(async()=>{o(!0),n(null);try{const u=await T(t);d(u),console.log("Watch Providers Data:",u)}catch(u){console.error("Error fetching watch providers:",u),n("시청 가능한 OTT 정보를 불러오는 데 실패했습니다.")}finally{o(!1)}})()},[t]),c)return e.jsx("p",{children:"시청 가능한 OTT 정보 로딩 중..."});if(h)return e.jsx("p",{style:{color:"red"},children:h});if(!r||!r.link||!r.flatrate&&!r.buy&&!r.rent)return e.jsx("p",{children:"시청 가능한 OTT 정보가 없습니다."});const p=[...r.flatrate||[],...r.buy||[],...r.rent||[]],a=Array.from(new Map(p.map(l=>[l.provider_id,l])).values());return e.jsxs(b,{children:[e.jsx("h2",{children:"시청하기"}),e.jsx("div",{children:a.map(l=>e.jsx(D,{providerName:l.provider_name,logoPath:l.logo_path,link:r.link,movieTitle:s},l.provider_id))})]})},D=({providerName:t,logoPath:s,link:r,movieTitle:d})=>{const c=_[t],o=c?`${c}${encodeURIComponent(d)}`:r;return e.jsxs(M,{href:o,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/original${s}`,alt:t}),e.jsx("span",{children:t})]})},$=m.div.withConfig({displayName:"styles__StyledBody",componentId:"sc-1ovi1i0-0"})(["background-color:",";color:",";padding:20px;min-height:100vh;box-sizing:border-box;@media (max-width:768px){padding:15px;}"],({theme:t})=>t.colors.background,({theme:t})=>t.colors.text),R=m.div.withConfig({displayName:"styles__StyledMovieBoxWrapper",componentId:"sc-1ovi1i0-1"})(["display:flex;flex-direction:column;align-items:center;margin-bottom:24px;@media (min-width:768px){flex-direction:row;align-items:flex-start;justify-content:center;}"]),z=()=>{const{id:t}=k(),s=t,[r,d]=i.useState(null),[c,o]=i.useState(!0),[h,n]=i.useState(null);return i.useEffect(()=>{(async()=>{if(!s){n("영화 ID가 없습니다."),o(!1);return}o(!0),n(null);try{const a=await B(Number(s));d(a)}catch(a){console.error("Error fetching movie detail:",a),n("영화 상세 정보를 불러오는 데 실패했습니다.")}finally{o(!1)}})()},[s]),c?e.jsx("p",{children:"영화 상세 정보 로딩 중..."}):h?e.jsx("p",{style:{color:"red"},children:h}):r?e.jsx(e.Fragment,{children:e.jsxs($,{children:[e.jsxs(R,{children:[e.jsx(P,{children:e.jsx(L,{movieId:Number(s),movie:r})}),e.jsxs(E,{children:[e.jsx(O,{movie:r}),e.jsx(C,{movieId:r.id})]})]}),e.jsx(W,{movieId:Number(s),movieTitle:r.title,children:e.jsx("h2",{children:"시청하기"})})]})}):e.jsx("p",{children:"영화 정보를 찾을 수 없습니다."})};export{z as default};
