import{B as g,r as s,D as N,E as R,I as _,J as L,K as E,N as k,O as q,Q as O,j as e,U as T,V,X as z,k as B}from"./index-CEgEPY2D.js";import{f as H,a as U}from"./omdbApi-BFlhVuM9.js";const W=g.div.withConfig({displayName:"styles__StyledDetailPage",componentId:"sc-15qb9g6-0"})(["min-height:100vh;background-color:",";color:",";.loading,.error{display:flex;justify-content:center;align-items:center;height:50vh;font-size:1.2rem;text-align:center;}"],({theme:t})=>t.colors.background,({theme:t})=>t.colors.text),J=g.div.withConfig({displayName:"styles__ContentContainer",componentId:"sc-15qb9g6-1"})(["max-width:1200px;margin:0 auto;padding:40px 20px;display:grid;grid-template-columns:2fr 1fr;gap:40px;align-items:start;@media (max-width:768px){grid-template-columns:1fr;gap:30px;padding:20px;}"]),K=g.main.withConfig({displayName:"styles__MainContent",componentId:"sc-15qb9g6-2"})(["h2{color:",";font-size:1.8rem;margin-bottom:20px;font-weight:600;}p{font-size:1.1rem;line-height:1.7;color:",";opacity:0.9;}"],({theme:t})=>t.colors.primary,({theme:t})=>t.colors.text),Q=g.aside.withConfig({displayName:"styles__Sidebar",componentId:"sc-15qb9g6-3"})(["display:flex;flex-direction:column;gap:24px;"]),X=g.section.withConfig({displayName:"styles__RecommendationsSection",componentId:"sc-15qb9g6-4"})(["max-width:1200px;margin:0 auto;padding:0 20px 40px;"]),Y=(t,a)=>{const[v,C]=s.useState(null),[m,o]=s.useState(null),[f,l]=s.useState([]),[w,h]=s.useState(!1),[y,c]=s.useState({imdbRating:null,rottenTomatoesRating:null}),[S,p]=s.useState(null),[I,d]=s.useState({isLoading:!0,error:null}),x=s.useCallback(async()=>{if(!t){d({isLoading:!1,error:"잘못된 영화 ID입니다."});return}const n=parseInt(t,10);if(isNaN(n)){d({isLoading:!1,error:"잘못된 영화 ID 형식입니다."});return}d({isLoading:!0,error:null});try{const[i,j,M,b,D]=await Promise.allSettled([N(n,a||void 0),R(n,a||void 0),_(n,a||void 0),L(n,a||void 0),E(n,a||void 0)]);if(i.status==="fulfilled")C(i.value);else throw new Error("영화 정보를 불러올 수 없습니다.");if(j.status==="fulfilled"?o(j.value):(console.warn("크레딧 정보를 불러오지 못했습니다:",j.reason),o(null)),M.status==="fulfilled"?l(M.value):(console.warn("추천 영화를 불러오지 못했습니다:",M.reason),l([])),b.status==="fulfilled"){const r=b.value.filter(u=>u.type==="Trailer"&&u.site==="YouTube");h(r.length>0)}else console.warn("비디오 정보를 불러오지 못했습니다:",b.reason),h(!1);if(D.status==="fulfilled"?p(D.value):(console.warn("시청 제공업체 정보를 불러오지 못했습니다:",D.reason),p(null)),i.status==="fulfilled")try{const r=await H(i.value.id);if(r){const u=await U(r);u&&c(u)}}catch(r){console.warn("외부 평점 정보를 불러오지 못했습니다:",r)}d({isLoading:!1,error:null})}catch(i){console.error("Error fetching movie details:",i),d({isLoading:!1,error:k(i)})}},[t,a]),P=s.useCallback(()=>{x()},[x]);return s.useEffect(()=>{x()},[x]),{movie:v,credits:m,recommendations:f,hasTrailer:w,ratings:y,watchProviders:S,loadingState:I,refetch:P}},G=()=>{const{id:t}=q(),[a]=O(),v=a.get("type"),[C,m]=s.useState(!1),{movie:o,credits:f,recommendations:l,hasTrailer:w,ratings:h,watchProviders:y,loadingState:c}=Y(t,v),S=()=>{m(!0)},p=()=>{m(!1)};return c.isLoading?e.jsx("div",{className:"loading",children:"영화 상세 정보 로딩 중..."}):c.error?e.jsx("div",{className:"error",style:{color:"red"},children:c.error}):o?e.jsxs(W,{children:[e.jsx(T,{movie:o,hasTrailer:w,isVideoModalOpen:C,onPlayTrailer:S,onCloseModal:p}),e.jsxs(J,{children:[e.jsxs(K,{children:[e.jsx("h2",{children:"줄거리"}),e.jsx("p",{children:o.overview||"줄거리 정보가 없습니다."})]}),e.jsxs(Q,{children:[e.jsx(V,{movie:o,ratings:h,watchProviders:y}),f&&e.jsx(z,{credits:f})]})]}),l.length>0&&e.jsx(X,{children:e.jsx(B,{movies:l,title:"추천 영화"})})]}):e.jsx("div",{className:"error",children:"영화 정보를 찾을 수 없습니다."})};export{G as default};
